{% extends 'master.html' %}
{% load static %}

{% block title %}Donation History{% endblock %}

{% block content %}
<div class="donation-history-container">
  <h2 class="page-title">ðŸ©¸ Your Donation History</h2>

  <div class="history-table-wrapper">
    <table class="history-table">
      <thead>
        <tr>
          <th>Donation Date</th>
          <th>Hospital</th>
          <th>Blood Group</th>
          <th>Units</th>
          <th>Status</th>
          <th>Next Eligible Date</th>
        </tr>
      </thead>
      <tbody>
        {% for donation in donations %}
        <tr>
          <td>{{ donation.donation_date|date:"Y-m-d" }}</td>
          <td>{{ donation.hospital.hospital_name }}</td>
          <td>
            {% if donation.donor.donordetail.blood_group %}
              {{ donation.donor.donordetail.blood_group }}
            {% else %}
              N/A
            {% endif %}
          </td>
          <td>{{ donation.blood_units|default:"0" }}</td>
          <td>
            {% if donation.status == 'Completed' %}
              <span class="status-badge completed">Completed</span>
            {% elif donation.status == 'Approved' %}
              <span class="status-badge pending">Approved</span>
            {% elif donation.status == 'Rejected' %}
              <span class="status-badge cancelled">Rejected</span>
            {% else %}
              <span class="status-badge pending">Pending</span>
            {% endif %}
          </td>
          <td>{{ donation.next_eligible_date|date:"Y-m-d" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="no-data">No past donations found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<style>
/* Container */
.donation-history-container {
  width: 90%;
  margin: 40px auto;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.1);
  padding: 40px;
}

/* Title */
.page-title {
  text-align: center;
  color: #c82333;
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 30px;
}

/* Table */
.history-table-wrapper { overflow-x: auto; }
.history-table {
  width: 100%;
  border-collapse: collapse;
  border-radius: 12px;
  overflow: hidden;
}
.history-table thead { background-color: #c82333; color: white; }
.history-table th, .history-table td { padding: 14px 12px; text-align: center; border-bottom: 1px solid #f2f2f2; font-size: 0.95rem; }
.history-table tr:hover { background-color: #fff6f6; }

/* Status Badges */
.status-badge { padding: 6px 12px; border-radius: 10px; font-weight: 600; font-size: 0.9rem; display: inline-block; }
.status-badge.completed { background-color: #d4edda; color: #155724; }
.status-badge.pending { background-color: #fff3cd; color: #856404; }
.status-badge.cancelled { background-color: #f8d7da; color: #721c24; }

/* No data message */
.no-data { color: #777; font-style: italic; padding: 20px; }

/* Responsive */
@media (max-width: 768px) {
  .history-table th, .history-table td { font-size: 0.85rem; padding: 10px; }
  .page-title { font-size: 1.6rem; }
}
</style>
{% endblock %}
